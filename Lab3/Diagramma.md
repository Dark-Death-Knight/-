### 2. Диаграмма потоков данных (Data Flow Diagram - DFD), для мобильного приложения Wildberries.

### Уровень: Контекстный (Level 0)

Эта диаграмма показывает систему как единое целое и ее взаимодействие с внешними сущностями.

<img width="4912" height="1884" alt="deepseek_mermaid_20250929_10d2d7" src="https://github.com/user-attachments/assets/6188ceb9-5147-4b04-82e6-0b3e5190afa1" />

### Детализированная диаграмма (Уровень 1)

Теперь разложим основной процесс «Система Wildberries» на ключевые подпроцессы.

<img width="7460" height="3709" alt="deepseek_mermaid_20250929_70f649" src="https://github.com/user-attachments/assets/b01c5c07-2c2b-4b60-8b3f-055a13bfa194" />


### Ключевые потоки данных:

Поисковые данные: Запрос → Поисковый индекс → ID товаров → База данных → Данные о товарах → Клиент.

Данные корзины: Команда изменения → Сервис корзины → Кэш Redis → Обновленная корзина → Клиент.

Данные заказа: Запрос на оформление → Сервис заказов (БД) → Платежный сервис (внешний шлюз) → Сервис доставки (внешний API) → Подтверждение → Клиент.

### Точки для улучшения, выявленные через DFD:

Слабая связность между Сервисом корзины и заказов:

Проблема: При оформлении заказа сервису заказов необходимо повторно запрашивать актуальные цены и наличие товаров из Базы данных, так как в кэше корзины они могли устареть.

Улучшение: Ввести этап "Резервирования товара" при оформлении. Сервис заказов отправляет запрос в Сервис каталога/склада для временного резервирования позиций на время оформления.

### Потенциальная точка отказа:

Проблема: Если Платежный шлюз (поток 17-18) не отвечает, весь процесс создания заказа блокируется.

Улучшение: Ввести асинхронную обработку платежей. Создавать заказ в статусе "Ожидает оплаты", а запрос к шлюзу помещать в надежную очередь (RabbitMQ, Kafka). Отдельный процесс будет обрабатывать эту очередь и обновлять статус заказа.

### Избыточность запросов:

Проблема: Сервис каталога делает два последовательных запроса (потоки 8->9 и 10->11) для поиска и получения деталей. Это увеличивает задержку.

Улучшение: Реализовать механизм "поиска с подгрузкой" в Поисковом индексе, где в самом индексе хранятся базовые данные (название, картинка, цена), достаточные для отображения в списке. Это позволит отдавать результаты поиска за один запрос.

Отсутствие потока данных для уведомлений:

Проблема: На диаграмме не отражено, как клиент узнает об изменении статуса заказа (например, "отправлен со склада") после его создания.

Улучшение: Добавить новый поток данных через Server-Sent Events (SSE) или WebSocket от Сервиса заказов обратно к Покупателю для push-уведомлений об изменении статуса.
